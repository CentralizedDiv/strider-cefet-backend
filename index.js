const express = require("express");
const app = express();
const cors = require("cors");

app.use(cors());

const port = 5000;

// Body parser
app.use(express.urlencoded({ extended: false }));

// Home route
app.get("/", (req, res) => {
  res.send("Welcome to a basic express App");
});

// Mock API
app.get("/get-cefet-geometry", (req, res) => {
  setTimeout(() => {
    res.json(
      [
        [-44.00073766708373, -19.939751982185285],
        [-43.998597264289856, -19.940301649756154],
        [-43.99796962738037, -19.939968823749066],
        [-43.998141288757324, -19.93815843969989],
        [-43.99895131587982, -19.938108010877784],
        [-43.9994341135025, -19.93818365410492],
        [-44.000174403190606, -19.938501355263245],
        [-44.00045871734619, -19.93868794135996],
        [-44.000635743141174, -19.93883418436276],
        [-44.00046408176422, -19.939010684358205],
        [-44.00073766708373, -19.939751982185285]
      ].map(coordinates => coordinates.reverse())
    );
  }, 1000);
});

app.get("/get-cefet-buildings", (req, res) => {
  const building20 = {
    name: "Prédio 20",
    color: "#2cd8d7",
    description: "O Prédio novo",
    coordinates: [
      [-44.00039166212082, -19.93874593429106],
      [-44.00019854307175, -19.939204834125416],
      [-43.99970233440399, -19.93893756295546],
      [-43.999967873096466, -19.938491269522018],
      [-44.00039166212082, -19.93874593429106]
    ].map(coordinates => coordinates.reverse())
  };
  const restaurant = {
    name: "Bandejão",
    color: "#7ee496",
    description: "Saudades comer pagando R$ 1,50",
    coordinates: [
      [-44.00017708539963, -19.939222484092415],
      [-44.000016152858734, -19.93939898365394],
      [-43.99950921535491, -19.939126669962125],
      [-43.999611139297485, -19.93890730581337],
      [-44.00017708539963, -19.939222484092415]
    ].map(coordinates => coordinates.reverse())
  };
  const library = {
    name: "Biblioteca",
    color: "#992db7",
    description: "...",
    coordinates: [
      [-43.99992495775223, -19.93948471194124],
      [-43.999780118465424, -19.939762067846022],
      [-43.99925708770752, -19.939507404715382],
      [-43.99942606687546, -19.939207355549385],
      [-43.99992495775223, -19.93948471194124]
    ].map(coordinates => coordinates.reverse())
  };
  const mainBuilding = {
    name: "Prédio Principal",
    color: "#d9a878",
    description: "Aulas da Graduação",
    coordinates: [
      [-43.99945825338364, -19.938967820091744],
      [-43.999128341674805, -19.939580525854325],
      [-43.99820566177368, -19.93906615574463],
      [-43.998607993125916, -19.93840301925872],
      [-43.99945825338364, -19.938967820091744]
    ].map(coordinates => coordinates.reverse())
  };
  const building12 = {
    name: "Predio 12",
    color: "#fe0441",
    description: "Aulas de Inf e Redes",
    coordinates: [
      [-43.99877965450287, -19.93993100256751],
      [-43.99862676858902, -19.940203314872505],
      [-43.99806082248688, -19.939905788441454],
      [-43.99820297956467, -19.939625911371813],
      [-43.99877965450287, -19.93993100256751]
    ].map(coordinates => coordinates.reverse())
  };
  setTimeout(() => {
    res.json([building20, restaurant, library, mainBuilding, building12]);
  }, 1000);
});

app.get("/get-student-tracking", (req, res) => {
  setTimeout(() => {
    res.json(
      [
        [-44.00176763534546, -19.940392420363626],
        [-44.00105953216553, -19.939338469540793],
        [-44.00076985359192, -19.938940084383706],
        [-44.000651836395264, -19.93877871289488],
        [-44.000362157821655, -19.93854674109084],
        [-44.000131487846375, -19.938410583568928],
        [-43.99982571601868, -19.93827442592964],
        [-43.99967551231384, -19.938345026201702],
        [-43.99946630001068, -19.938627426974364],
        [-43.99949312210083, -19.938773670033196],
        [-43.9997398853302, -19.938950170096284],
        [-44.00005102157593, -19.93895521295233],
        [-43.99995982646942, -19.93919222700492],
        [-43.99955749511719, -19.93895521295233],
        [-43.999353647232056, -19.9392930839407],
        [-43.9995414018631, -19.939464540583714],
        [-43.99927854537963, -19.93939898365394],
        [-43.999128341674805, -19.93967129687626],
        [-43.99897813796997, -19.93979232482435],
        [-43.998650908470154, -19.939625911371813],
        [-43.998393416404724, -19.93992343833011],
        [-43.99845778942108, -19.939504883296195],
        [-43.99825394153595, -19.93936872660026],
        [-43.998157382011414, -19.9391821413078],
        [-43.99823248386383, -19.93877871289488],
        [-43.9983719587326, -19.938597169772876],
        [-43.99861335754394, -19.938677855630637],
        [-43.99880647659302, -19.938682898495387],
        [-43.998881578445435, -19.93853161248309],
        [-43.999342918395996, -19.938597169772876],
        [-43.9994877576828, -19.93829459743916],
        [-43.99951994419097, -19.93815843969989]
      ].map(coordinates => coordinates.reverse())
    );
  }, 3000);
});

// Listen on port 5000
app.listen(port, () => {
  console.log(`Server is booming on port 5000 Visit http://localhost:5000`);
});
